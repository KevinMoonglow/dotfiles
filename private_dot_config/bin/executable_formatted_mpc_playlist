#!/usr/bin/fish

set -l entries (mpc playlist -f '%title%	%album%	%artist%	%file%')
set -l index 0

for e in $entries
    set index (math $index + 1)

    set -l item (string split "	" $e)
    
    set -l filename $item[4]

    if test -z (string trim $item[1])
        set -f title (string sub --length 50 (basename $item[4]))
    else
        set -f title (string sub --length 50 $item[1])
    end

    set -l album (string sub --length 25 $item[2])
    set -l artist (string sub --length 20 $item[3])



    printf "ğŸµ %-50s	%-25s %-20s\0meta\x1f%s %s %s %s\x1finfo\x1f%s\n" $title $album $artist $item[1] $item[2] $item[3] $filename $index
end
